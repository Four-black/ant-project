# 课程创建功能设计说明

## 一、数据库设计

### 1. chapters (章节表)
```sql
- id: BIGINT 主键自增
- title: VARCHAR(200) 章节标题
- objectives: TEXT 学习目标
- chapter_order: INT 章节顺序
- course_id: BIGINT 所属课程ID
- created_at: TIMESTAMP 创建时间
- updated_at: TIMESTAMP 更新时间
```

### 2. chapter_contents (知识点表)
```sql
- id: BIGINT 主键自增
- chapter_id: BIGINT 所属章节ID
- content_text: VARCHAR(500) 知识点内容
- content_order: INT 知识点顺序
- created_at: TIMESTAMP 创建时间
- updated_at: TIMESTAMP 更新时间
```

## 二、后端实现

### 创建的文件：
1. ✅ `Chapter.java` - 章节实体类
2. ✅ `ChapterContent.java` - 知识点实体类
3. ✅ `ChapterMapper.java` - 章节Mapper
4. ✅ `ChapterContentMapper.java` - 知识点Mapper
5. ✅ `ChapterService.java` - 章节服务接口
6. ✅ `ChapterServiceImpl.java` - 章节服务实现
7. ✅ `CourseCreateDTO.java` - 课程创建DTO
8. ✅ 更新 `CourseInfoController.java` - 添加创建课程API

### 核心API：
**POST** `/api/courseInfo/create`
- 功能：创建课程（包含基本信息和章节）
- 请求体：
```json
{
  "courseInfo": {
    "courseName": "课程名称",
    "instructor": "教师",
    "startTime": "2024-01-01",
    "endTime": "2024-06-30",
    "coverImage": "图片URL",
    "duration": "40学时",
    "description": "课程简介",
    "prerequisites": "预备知识",
    "experimentCount": 5,
    "referenceMaterials": "参考资料"
  },
  "chapters": [
    {
      "title": "第一章 标题",
      "objectives": "学习目标",
      "chapterOrder": 1,
      "contents": [
        {
          "contentText": "知识点1",
          "contentOrder": 1
        }
      ]
    }
  ]
}
```

## 三、前端实现

### addclass 页面包含：
1. **课程基本信息表单**
   - 课程名称 ✅
   - 授课教师 ✅
   - 开始/结束时间 ✅
   - 课程封面URL ✅
   - 课程时长 ✅
   - 课程简介 ✅
   - 预备知识 ✅
   - 实验数量 ✅
   - 参考资料 ✅

2. **章节编辑器**
   - 添加/删除章节 ✅
   - 上移/下移章节 ✅
   - 章节标题编辑 ✅
   - 学习目标编辑（带提示） ✅
   - 知识点动态添加/删除 ✅
   - 自动序号生成 ✅

## 四、使用流程

### 步骤1：执行SQL创建表
```bash
# 在 MySQL 中执行
source demos/src/main/resources/sql/create_chapter_tables.sql
```

### 步骤2：启动后端
```bash
cd demos
# 如果用 Maven
./mvnw spring-boot:run
```

### 步骤3：启动前端
```bash
cd myapp
npm start
```

### 步骤4：创建课程
1. 访问 http://localhost:8000/class/addclass
2. 填写课程基本信息
3. 添加章节并编辑内容
4. 点击"创建课程"提交

## 五、数据流程

```
前端表单
  ↓
CourseCreateDTO
  ↓
CourseInfoController.createCourse()
  ↓
保存 CourseInfo → 获取 courseId
  ↓
批量保存 Chapters
  ↓
为每个 Chapter 保存 ChapterContents
  ↓
返回成功 → 跳转到课程列表
```

## 六、注意事项

1. **事务管理**：创建课程使用 `@Transactional`，保证数据一致性
2. **级联删除**：删除章节时自动删除关联知识点
3. **顺序管理**：使用 `chapter_order` 和 `content_order` 维护顺序
4. **时间自动填充**：创建和更新时间自动设置

## 七、扩展建议

1. 添加图片上传功能（课程封面）
2. 添加课程编辑功能
3. 添加章节内容富文本编辑
4. 添加章节导入/导出功能
